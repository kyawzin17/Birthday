<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday For My Lover</title>
    <link href="style.css" rel="stylesheet" />
</head>
<body>
    <div class="main-container">
        <audio id="audio" autoplay>
            <source src="Touse/happy.m4a">
        </audio>
        <div class="header">
            <nav class="navbar">
                <a href="#home" data-target="home" class="nav-item">Home</a>
                <a href="#gift" data-target="gift" class="nav-item">Gift</a>
                <a href="#album" data-target="album" class="nav-item">Album</a>
                <a href="#wishes" data-target="wishes" class="nav-item">Wishes</a>
            </nav>
        </div>
        <div class="container">
            <svg width="250" height="250" class="circle-style">
                <circle cx="125" cy="125" r="100" fill="#FF6584"/>
            </svg>
            <svg width="250" height="250" class="circle-style1">
                <circle cx="125" cy="125" r="100" fill="#FF6584"/>
            </svg>
            <section class="home" id="home">
                <h2 class="home-h2">Happy Birthday, Dear Ei Mon Kyaw</h2>
                <p class="home-p">To the one who fills my life with joy and love. Every moment with you is a gift.</p>
                <button class="home-btn">My gift ✨</button>
            </section>
            <section id="gift" class="section">
                <div class="gift">
                    <h2>❤️ မွေးနေ့မှာ ပျော်ရွှင်ပါစေနော် ✨</h2>
                    <div id="info" class="info"> </div>
                    <button class="gift-btn" id="start">Start ❤️</button>
                </div>
            </section>
            <section id="album" class="section">
                <div class="album">
                
                    <div class="banner" id="banner">
                        <div id="flower" class="flower"></div>
                        <div class="slider" style="--quantity: 10">
                            <div class="photo-item" style="--position: 1"><img src="/Touse/h1.jpeg" /></div>
                            <div class="photo-item" style="--position: 2"><img src="/Touse/h2.jpeg" /></div>
                            <div class="photo-item" style="--position: 3"><img src="/Touse/h3.jpg" /></div>
                            <div class="photo-item" style="--position: 4"><img src="/Touse/h4.jpg" /></div>
                            <div class="photo-item" style="--position: 5"><img src="/Touse/h5.jpg" /></div>
                            <div class="photo-item" style="--position: 6"><img src="/Touse/h7.jpeg" /></div>
                            <div class="photo-item" style="--position: 7"><img src="/Touse/h8.jpg" /></div>
                            <div class="photo-item" style="--position: 8"><img src="/Touse/h9.jpg" /></div>
                            <div class="photo-item" style="--position: 9"><img src="/Touse/h10.jpg" /></div>
                            <div class="photo-item" style="--position: 10"><img src="/Touse/h11.jpg" /></div>
                        </div>
                    </div>
                    <div class="smoot-album">
                        <div class="img-con">
                            <div class="a-item a-active"><img src="Touse/v7.jpeg" alt="Her img!" width="250" /></div>
                            <div class="a-item"><img src="Touse/v4.jpg" alt="Her img!" width="250" /></div>
                            <div class="a-item"><img src="Touse/v3.jpg" alt="Her img!" width="250" /></div>
                            <div class="a-item"><img src="Touse/v6.jpeg" alt="Her img!" width="250" /></div>
                            <div class="a-item"><img src="Touse/v8.jpeg" alt="Her img!" width="250" /></div>
                        </div>
                    </div>

                </div>
            </section>
            <section id="wisher" class="section">
                            <div class="wishes section" id="wishes">
                    <div class="wish-head">
                        <h2>My Wishes!</h2>
                        <p>✦•┈๑⋅⋯ ⋯⋅๑┈•✦</p>
                    </div>
                    <div class="text-page">
                        <div class="card-head">
                            <svg width="80" height="80" viewBox="0 0 80 80" class="card-circle">
                                <defs>
                                    <pattern id="imgPattern" width="1" height="1">
                                        <image href="Touse/me.png"
                                            x="-8"
                                        width="75" height="75"
                                        preserveAspectRatio="xMidYMid slice"/>
                                    </pattern>
                                </defs>
                                <circle cx="40" cy="40" r="30" stroke="#00C9A7" stroke-width="2px" fill="url(#imgPattern)"/>
                            </svg>
                            <p>P. Stranger</p>
                        </div>
                        <p> 
                            ချစ်ဆုံး‌ရေ ၂၂ နှစ်မြှောက်မွေးနေ့မှစ၍ နောင်နှစ်ပေါင်းများစွာ တိုင်အောင် ပျော်ရွှင်သော ဘဝလေးကို ပိုင်ဆိုင်နိုင်ပါစေ။
                            ချစ်ရသူတွေနဲ့လဲ ဆထက်တိုးလို့ ချစ်နိုင်ပါစေဗျ။ ဖြစ်ချင်သော ဆန္ဒများလဲ အမြန်ပြည့်နိုင်ပါစေနော်။
                            ကျမ်းမာ ချမ်းသာစွာနဲ့ ဘဝတစ်လျောက်လုံး အပူအပင်ကင်းစွာနဲ့ ဖြတ်သန်းနိုင်ပြီး နိဗ္ဗာန် ရောက်ကြောင်း တရားတော်များကိုလဲ သိမြင်နိုင်ပါစေ။
                                ရွာမှာကျန်ခဲ့ သော ကောင်လေးကိုလဲ အများကြီး ချစ်နိုင်ပါစေဗျ &#128513; ။
                                မိဘ အပေါ်လဲ သားသမီးဝတ္ထရားတွေ ကျေနိုင်ပြီး သမီးလိမ္မာလေးလဲ ဖြစ်နိုင်ပါစေနော်။
                        </p>
                        <h2>-Birthday Wishes For My Lover!❤️</h2>
                    </div>
                </div>
            </section>
        </div>
        <div class="footer">
            © 21, 12, 2025 For My Love ❤️ | Happy Birthday!
        </div>
        <canvas class="canvas" id="confetti-canvas"></canvas>
    </div>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        function module3d(Id, modelPath, hasBackground = false) {
            // 1. Scene Setup
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0a12);
        // if (!hasBackground) {
        //     scene.background = new THREE.Color(0x0a0a12);
        // }else {
        //      scene.background= new THREE.Color(0xF4F6FC);
        // }
        
        // 2. Camera Setup
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 1, 5);

        // 3. Renderer Setup
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.getElementById(Id).appendChild(renderer.domElement);

        // 4. Lights
        const ambientLight = new THREE.AmbientLight(0xffffff, 1);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 2);
        directionalLight.position.set(5, 10, 7.5);
        scene.add(directionalLight);

        const fillLight = new THREE.PointLight(0x7c4dff, 1);
        fillLight.position.set(-5, 2, -5);
        scene.add(fillLight);

        // 5. Controls (Mouse နဲ့ လှည့်ကြည့်လို့ရအောင်)
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;

        // 6. Load the .glb File
        let model;
        const loader = new GLTFLoader();
        loader.load(modelPath, function (gltf) {
            model = gltf.scene;
            scene.add(model);
            
            // Model ကို screen အလယ်ရောက်အောင် ချိန်ညှိခြင်း
            const box = new THREE.Box3().setFromObject(model);
            const center = box.getCenter(new THREE.Vector3());
            model.position.sub(center);
            
            console.log("Model loaded successfully!");
        }, undefined, function (error) {
            console.error('Error loading model:', error);
        });


        // Fireworks logic
        const fireworks = [];
        let count;
        function createFirework() {
            if(!hasBackground) {
                count= 140;
            }else {
                count= 0;
            }
            const particleCount = count;
            const geometry = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);
            const color = new THREE.Color();
            //color.setColorName("red");
            color.setHSL(Math.random(), 1, 0.6);  //Random တောက်ပတဲ့ အရောင်များ

            for (let i = 0; i < particleCount; i++) {
                positions[i * 3] = 0;
                positions[i * 3 + 1] = 0;
                positions[i * 3 + 2] = 0;
                colors[i * 3] = color.r;
                colors[i * 3 + 1] = color.g;
                colors[i * 3 + 2] = color.b;
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

            const material = new THREE.PointsMaterial({
                size: 0.15,
                vertexColors: true,
                transparent: true,
                opacity: 1,
                blending: THREE.AdditiveBlending // မီးပန်းတွေ ပိုလင်းသွားစေဖို့
            });

            const particles = new THREE.Points(geometry, material);
            
            // Model ရဲ့ ဘေးပတ်ပတ်လည်မှာ ပေါက်ကွဲစေရန်
            particles.position.set(
                (Math.random() - 0.5) * 6,
                1 + Math.random() * 4,
                (Math.random() - 0.5) * 6
            );
            
            const velocities = [];
            for (let i = 0; i < particleCount; i++) {
                const phi = Math.random() * Math.PI * 2;
                const theta = Math.random() * Math.PI;
                const speed = 0.05 + Math.random() * 0.15;
                
                velocities.push(new THREE.Vector3(
                    Math.sin(theta) * Math.cos(phi) * speed,
                    Math.sin(theta) * Math.sin(phi) * speed,
                    Math.cos(theta) * speed
                ));
            }

            scene.add(particles);
            fireworks.push({ particles, velocities, life: 3.0 });
        }

        document.getElementById('start').addEventListener('click', () => {
            const audioTag= document.getElementById("audio");
            if (audioTag.paused) {
                audioTag.play();
            setTimeout(() => {
                for(let i=0; i< 50; i++) {
                setTimeout(createFirework, i * 150);
            }
            }, 5000);
            } else {
                for(let i=0; i< 50; i++) {
                setTimeout(createFirework, i * 150);
            }
            }
            
        });

        // 7. Animation Loop
        function animate() {
            requestAnimationFrame(animate);
            if (model) {
              model.rotation.y += 0.02;
            }
            if (!hasBackground) {
            // Update Fireworks
            for (let i = fireworks.length - 1; i >= 0; i--) {
        const fw = fireworks[i];
        const positions = fw.particles.geometry.attributes.position.array;
        
        for (let j = 0; j < fw.velocities.length; j++) {
            positions[j * 3] += fw.velocities[j].x;
            positions[j * 3 + 1] += fw.velocities[j].y;
            positions[j * 3 + 2] += fw.velocities[j].z;
            
            // Gravity ကို လျှော့ထားလို့ အောက်ကို ဖြည်းဖြည်းပဲ ကျမယ်
            fw.velocities[j].y -= 0.0005; 
        }
        
        fw.particles.geometry.attributes.position.needsUpdate = true;
        
        // ဒီဂဏန်းကို လျှော့လိုက်တာက မီးပန်းကို ကြာကြာလင်းနေစေတာပါ
        fw.life -= 0.005; 
        fw.particles.material.opacity = fw.life;

        if (fw.life <= 0) {
            scene.remove(fw.particles);
            fireworks.splice(i, 1);
        }
            }
            
        }else {
             console.log("this is flower!")
        }
            
            controls.update();
            renderer.render(scene, camera);
        }

        // Handle Window Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
        }
        module3d("info", "Untitled.glb");
        module3d("flower", "Untitled1.glb", true);
    </script>
    <script src="main.js"></script>
</body>
</html>